import jwt_decode from "jwt-decode";
import { useNavigate } from 'react-router-dom';

const navigate = useNavigate();


const checkTokenValidity = () => {
    console.log('checkTokenValidity')
  const token = localStorage.getItem("token");
  if (token) {
    const decodedToken = jwt_decode(token);
    const currentTime = Date.now() / 1000;

    if (decodedToken.exp < currentTime) {
      // Token has expired, redirect to login
      localStorage.removeItem("token");
      window.location.href = "/login";
    }
  }
};

const startTokenManager = () => {
  // Check token validity every 5 seconds
  setInterval(checkTokenValidity, 5000);
};

export default startTokenManager;